import{r as o,j as e,e as u,d as p,g as b}from"./index-CdmV0IkD.js";import{c as l,I as P,B as k}from"./button-CJI64WiL.js";const g=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:l("w-full caption-bottom text-sm",t),...r})}));g.displayName="Table";const j=o.forwardRef(({className:t,...r},s)=>e.jsx("thead",{ref:s,className:l("[&_tr]:border-b",t),...r}));j.displayName="TableHeader";const N=o.forwardRef(({className:t,...r},s)=>e.jsx("tbody",{ref:s,className:l("[&_tr:last-child]:border-0",t),...r}));N.displayName="TableBody";const T=o.forwardRef(({className:t,...r},s)=>e.jsx("tfoot",{ref:s,className:l("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));T.displayName="TableFooter";const f=o.forwardRef(({className:t,...r},s)=>e.jsx("tr",{ref:s,className:l("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));f.displayName="TableRow";const d=o.forwardRef(({className:t,...r},s)=>e.jsx("th",{ref:s,className:l("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));d.displayName="TableHead";const i=o.forwardRef(({className:t,...r},s)=>e.jsx("td",{ref:s,className:l("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));i.displayName="TableCell";const S=o.forwardRef(({className:t,...r},s)=>e.jsx("caption",{ref:s,className:l("mt-4 text-sm text-muted-foreground",t),...r}));S.displayName="TableCaption";const R=()=>{const[t,r]=o.useState([]);return o.useEffect(()=>{const s=async()=>{try{const c=localStorage.getItem("authToken");if(!c)throw u.error("No authentication token found"),new Error("No authentication token found");const m=await p.get("/api/v1/order",{headers:{Authorization:`Bearer ${c}`}});r(m.data.orders.reverse()),u.success("Orders fetched successfully!")}catch(c){console.error("Error fetching orders:",c),u.error("Failed to fetch orders. Please try again.")}};s();const n=setInterval(s,5e3);return()=>clearInterval(n)},[]),e.jsxs("div",{className:"container mx-auto py-10 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Orders"}),e.jsxs(g,{children:[e.jsx(j,{children:e.jsxs(f,{children:[e.jsx(d,{children:"Name"}),e.jsx(d,{children:"Quantity"}),e.jsx(d,{children:"Address"}),e.jsx(d,{children:"Phone"}),e.jsx(d,{children:"Items"}),e.jsx(d,{children:"Created At"})]})}),e.jsx(N,{children:t.map(s=>e.jsxs(f,{children:[e.jsx(i,{children:s.name}),e.jsx(i,{children:s.quantity}),e.jsx(i,{children:s.address}),e.jsx(i,{children:e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})}),e.jsx(i,{children:s.items.map((n,c)=>e.jsxs("div",{children:[n.name," - ",n.quantity," x RS: ",n.price.toFixed(2)]},c))}),e.jsx(i,{children:new Date(s.createdAt).toLocaleString()})]},s._id))})]})]})},E=()=>{const[t,r]=o.useState(""),{login:s}=b(),n=async()=>await s(t);return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-96",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Login"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx(P,{id:"password",type:"password",value:t,onChange:c=>r(c.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter your password"})]}),e.jsx(k,{onClick:n,disabled:!t,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Login"})]})]})})},A=()=>{const[t,r]=o.useState([]),[s,n]=o.useState(null),[c,m]=o.useState("");o.useEffect(()=>{(async()=>{try{const h=localStorage.getItem("authToken");if(!h)throw new Error("No authentication token found");const x=await p.get("/api/v1/market/prices",{headers:{Authorization:`Bearer ${h}`}});r(x.data),u.success("Product prices fetched successfully!")}catch(h){console.error("Error fetching product prices:",h),u.error("Failed to fetch product prices. Please try again.")}})()},[]);const y=a=>{n(a),m(a.price)},w=a=>{m(Number(a.target.value))},v=async()=>{if(s&&c!=="")try{const a=localStorage.getItem("authToken");if(!a)throw new Error("No authentication token found");const h=await p.put(`/api/v1/market/prices/${s._id}`,{price:c},{headers:{Authorization:`Bearer ${a}`}});r(t.map(x=>x._id===s._id?h.data:x)),n(null),m(""),u.success("Product price updated successfully!")}catch(a){console.error("Error updating product price:",a),u.error("Failed to update product price. Please try again.")}};return e.jsxs("div",{className:"container mx-auto py-10 px-4 pb-24",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Product Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Product Prices"}),e.jsx("ul",{children:t.map(a=>e.jsx("li",{className:"mb-2",children:e.jsxs("button",{className:"text-blue-500 hover:underline",onClick:()=>y(a),children:[a.product,": ",a.price]})},a._id))})]}),e.jsx("div",{children:s&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Update Price for ",s.product]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),v()},className:"flex flex-col gap-4",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700",children:"New Price"}),e.jsx("input",{type:"number",value:c,onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm",required:!0})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Update Price"})]})]})})]})]})},I=()=>{const{isAuthenticated:t}=b();return e.jsx(e.Fragment,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(R,{})," ",e.jsx(A,{})]}):e.jsx(E,{})})};export{I as default};
