import{r as o,j as e,d as u,g as b}from"./index-C7u9B10s.js";import{c as l,I as v,B as P}from"./button-BfvpUfKu.js";const f=o.forwardRef(({className:t,...r},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:l("w-full caption-bottom text-sm",t),...r})}));f.displayName="Table";const j=o.forwardRef(({className:t,...r},s)=>e.jsx("thead",{ref:s,className:l("[&_tr]:border-b",t),...r}));j.displayName="TableHeader";const g=o.forwardRef(({className:t,...r},s)=>e.jsx("tbody",{ref:s,className:l("[&_tr:last-child]:border-0",t),...r}));g.displayName="TableBody";const k=o.forwardRef(({className:t,...r},s)=>e.jsx("tfoot",{ref:s,className:l("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...r}));k.displayName="TableFooter";const p=o.forwardRef(({className:t,...r},s)=>e.jsx("tr",{ref:s,className:l("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...r}));p.displayName="TableRow";const d=o.forwardRef(({className:t,...r},s)=>e.jsx("th",{ref:s,className:l("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));d.displayName="TableHead";const i=o.forwardRef(({className:t,...r},s)=>e.jsx("td",{ref:s,className:l("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...r}));i.displayName="TableCell";const T=o.forwardRef(({className:t,...r},s)=>e.jsx("caption",{ref:s,className:l("mt-4 text-sm text-muted-foreground",t),...r}));T.displayName="TableCaption";const S=()=>{const[t,r]=o.useState([]);return o.useEffect(()=>{const s=async()=>{try{const n=localStorage.getItem("authToken");if(!n)throw new Error("No authentication token found");const m=await u.get("/api/v1/order",{headers:{Authorization:`Bearer ${n}`}});r(m.data.orders.reverse())}catch(n){console.error("Error fetching orders:",n)}};s();const c=setInterval(s,5e3);return()=>clearInterval(c)},[]),e.jsxs("div",{className:"container mx-auto py-10 px-4",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Orders"}),e.jsxs(f,{children:[e.jsx(j,{children:e.jsxs(p,{children:[e.jsx(d,{children:"Name"}),e.jsx(d,{children:"Quantity"}),e.jsx(d,{children:"Address"}),e.jsx(d,{children:"Phone"}),e.jsx(d,{children:"Items"}),e.jsx(d,{children:"Created At"})]})}),e.jsx(g,{children:t.map(s=>e.jsxs(p,{children:[e.jsx(i,{children:s.name}),e.jsx(i,{children:s.quantity}),e.jsx(i,{children:s.address}),e.jsx(i,{children:e.jsx("a",{href:`tel:${s.phone}`,children:s.phone})}),e.jsx(i,{children:s.items.map((c,n)=>e.jsxs("div",{children:[c.name," - ",c.quantity," x RS: ",c.price.toFixed(2)]},n))}),e.jsx(i,{children:new Date(s.createdAt).toLocaleString()})]},s._id))})]})]})},R=()=>{const[t,r]=o.useState(""),{login:s}=b(),c=()=>{s(t)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-96",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Login"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx(v,{id:"password",type:"password",value:t,onChange:n=>r(n.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Enter your password"})]}),e.jsx(P,{onClick:c,disabled:!t,className:"w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:"Login"})]})]})})},E=()=>{const[t,r]=o.useState([]),[s,c]=o.useState(null),[n,m]=o.useState("");o.useEffect(()=>{(async()=>{try{const h=localStorage.getItem("authToken");if(!h)throw new Error("No authentication token found");const x=await u.get("/api/v1/market/prices",{headers:{Authorization:`Bearer ${h}`}});r(x.data)}catch(h){console.error("Error fetching product prices:",h)}})()},[]);const N=a=>{c(a),m(a.price)},w=a=>{m(Number(a.target.value))},y=async()=>{if(s&&n!=="")try{const a=localStorage.getItem("authToken");if(!a)throw new Error("No authentication token found");const h=await u.put(`/api/v1/market/prices/${s._id}`,{price:n},{headers:{Authorization:`Bearer ${a}`}});r(t.map(x=>x._id===s._id?h.data:x)),c(null),m("")}catch(a){console.error("Error updating product price:",a)}};return e.jsxs("div",{className:"container mx-auto py-10 px-4 pb-24",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Product Management"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Product Prices"}),e.jsx("ul",{children:t.map(a=>e.jsx("li",{className:"mb-2",children:e.jsxs("button",{className:"text-blue-500 hover:underline",onClick:()=>N(a),children:[a.product,": ",a.price]})},a._id))})]}),e.jsx("div",{children:s&&e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4",children:["Update Price for ",s.product]}),e.jsxs("form",{onSubmit:a=>{a.preventDefault(),y()},className:"flex flex-col gap-4",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700",children:"New Price"}),e.jsx("input",{type:"number",value:n,onChange:w,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm",required:!0})]}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Update Price"})]})]})})]})]})},I=()=>{const{isAuthenticated:t}=b();return e.jsx(e.Fragment,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(S,{})," ",e.jsx(E,{})]}):e.jsx(R,{})})};export{I as default};
